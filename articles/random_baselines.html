<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Baseline model comparisons • motifr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Baseline model comparisons">
<meta property="og:description" content="motifr">
<meta property="og:image" content="https://marioangst.github.io/motifr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">motifr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/motif_zoo.html">The motif zoo</a>
    </li>
    <li>
      <a href="../articles/random_baselines.html">Baseline model comparisons</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/marioangst/motifr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Baseline model comparisons</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/marioangst/motifr/blob/master/vignettes/random_baselines.Rmd"><code>vignettes/random_baselines.Rmd</code></a></small>
      <div class="hidden name"><code>random_baselines.Rmd</code></div>

    </div>

    
    
<p><a href="https://marioangst.github.io/motifr/"><img src="../man/figures/logo.svg" align="right" height="139"></a></p>
<p>This vignette describes the models used to specify baseline motif distributions to compare empirically observed networks against in motifr. Baseline models have to be specified when requesting random networks to compare empirically observed networks against (e.g. using <code><a href="../reference/compare_to_baseline.html">compare_to_baseline()</a></code>), and when computing properties of motif distributions analytically (e.g, <code><a href="../reference/motifs_distribution.html">motifs_distribution()</a></code>).</p>
<div id="baseline-models" class="section level2">
<h2 class="hasAnchor">
<a href="#baseline-models" class="anchor"></a>Baseline models</h2>
<p>Currently, four baseline models are implemented. The parameters of the models are extracted from a given (empirical) network.</p>
<ul>
<li>
<em>Fixed Densities Model</em> (<code>fixed_densities</code>) Given two levels A and B, in this model it is assumed that the number of edges between level A and level B is fixed for all A-B ties. The specific number of edges is drawn randomly from the set of all possible edges.</li>
<li>
<em>Erdős-Rényi Model</em> (<code>erdos_renyi</code>) In this model edges <em>between</em> the various levels are drawn independently at random with respect to a fixed probability depending on the levels. The (refined) Erdős-Rényi model accounts for the various levels by allowing to specify different probabilities ties occurring <em>within</em> different levels.</li>
<li>
<em>Actor’s Choice Model</em> (<code>actors_choice</code>) In this model all edges but the edges on one specific level are fixed. This is motivated by theoretical considerations about the application of multi-level network models in situations where one level is composed of actors, which are more readily able to change their connections, and other levels considered more stable, e.g. specific instances of ecological networks. The edges on this non-fixed “actor level” are chosen independently with fixed probability as in Erdős-Rényi.</li>
<li>
<em>Exponential Random Graph Model</em> (<code>ergm</code>) Sophisticated model which accounts for various network parameters. Please consult the documentation of <code><a href="https://rdrr.io/pkg/ergm/man/ergm.html">ergm::ergm()</a></code> for details.</li>
<li>
<em>Partial Exponential Random Graph Model</em> (<code>partial_ergm</code>) It tends to be hard to fit an ERGM to a multi-level network. However, this can be often avoided by using ERGM only for modelling the behaviour of one level while keeping the other levels fixed, motivated by the same theoretical considerations as for the Actor’s choice model.</li>
</ul>
<p>For further details see the <a href="https://gitlab.com/t.seppelt/sesmotifanalyser/raw/master/doc/_build/latex/SESMotifAnalyser.pdf?inline=false">documentation of the Python sma package</a>.</p>
</div>
<div id="motifs-in-networks-simulated-based-on-a-baseline-model" class="section level2">
<h2 class="hasAnchor">
<a href="#motifs-in-networks-simulated-based-on-a-baseline-model" class="anchor"></a>Motifs in networks simulated based on a baseline model</h2>
<p>Motifs in random networks can be counted using <code><a href="../reference/simulate_baseline.html">simulate_baseline()</a></code>. The supported models are <code>erdos_renyi</code>, <code>fixed_densities</code>, <code>actors_choice</code> and <code>ergm</code>. The function <code><a href="../reference/compare_to_baseline.html">compare_to_baseline()</a></code> can be used for plotting the results:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/simulate_baseline.html">simulate_baseline</a></span><span class="op">(</span><span class="va">ml_net</span>, motifs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"1,2[I.C]"</span>, <span class="st">"1,2[II.C]"</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">5</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt;   1,2[I.C] 1,2[II.C]</span>
<span class="co">#&gt; 1      139        13</span>
<span class="co">#&gt; 2      159        17</span>
<span class="co">#&gt; 3      141        15</span>
<span class="co">#&gt; 4      117        20</span>
<span class="co">#&gt; 5      201        15</span></code></pre></div>
</div>
<div id="motif-distributions-without-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#motif-distributions-without-simulation" class="anchor"></a>Motif distributions without simulation</h2>
<p>Expectations and variances in <code>erdos_renyi</code> and <code>actors_choice</code> can be computed analytically, i.e. without simulating hundreds of random networks. Until now variances can only be computed for 1,2-motifs.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/motifs_distribution.html">motifs_distribution</a></span><span class="op">(</span><span class="va">ml_net</span>, motifs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"1,2[I.C]"</span>, <span class="st">"2,2[II.D]"</span><span class="op">)</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt;               motif expectation variance</span>
<span class="co">#&gt; 1,2[I.C]   1,2[I.C]   169.14423 949.7743</span>
<span class="co">#&gt; 2,2[II.D] 2,2[II.D]    68.83919 968.5823</span></code></pre></div>
</div>
<div id="difference-between-erdős-rényi-and-fixed-densities" class="section level2">
<h2 class="hasAnchor">
<a href="#difference-between-erd%C5%91s-r%C3%A9nyi-and-fixed-densities" class="anchor"></a>Difference between Erdős-Rényi and Fixed Densities</h2>
<p>There is a crucial difference between the Erdős-Rényi model and Fixed Densities model. In the former, the expected number of edges on each level equals the number of edges in the empirical network, while in the latter the exact number in each random network equals this number. This difference becomes obvious when counting edges in random networks. For a network with two levels A and B <code>1,1[1]</code> is the motif consisting of one node from level A and one from level B, linked by an edge.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/compare_to_baseline.html">compare_to_baseline</a></span><span class="op">(</span><span class="va">ml_net</span>, motifs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"1,1[1]"</span><span class="op">)</span>, model <span class="op">=</span> <span class="st">"erdos_renyi"</span>, n <span class="op">=</span> <span class="fl">50</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="random_baselines_chunk3-1.svg" alt="plot of chunk random_baselines_chunk3"><p class="caption">plot of chunk random_baselines_chunk3</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/compare_to_baseline.html">compare_to_baseline</a></span><span class="op">(</span><span class="va">ml_net</span>, motifs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"1,1[1]"</span><span class="op">)</span>, model <span class="op">=</span> <span class="st">"fixed_densities"</span>, n <span class="op">=</span> <span class="fl">50</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="random_baselines_chunk3-2.svg" alt="plot of chunk random_baselines_chunk3"><p class="caption">plot of chunk random_baselines_chunk3</p>
</div>
</div>
<div id="level-selection-in-actors-choice-model" class="section level2">
<h2 class="hasAnchor">
<a href="#level-selection-in-actors-choice-model" class="anchor"></a>Level selection in Actor’s Choice Model</h2>
<p>In the Actor’s Choice Model all levels in the network except for one are assumed to be fixed. The edges in the remaining variable (or actor’s) level are drawn randomly according to the Erdős-Rényi Model. The variable level can be selected using the <code>level</code> parameter, e.g. in <code><a href="../reference/motifs_distribution.html">motifs_distribution()</a></code>, or determined automatically. The default level is the first level providing exactly two nodes in the motif. Note that <code><a href="../reference/simulate_baseline.html">simulate_baseline()</a></code> and <code><a href="../reference/compare_to_baseline.html">compare_to_baseline()</a></code> do not support automatic level selection.</p>
<p>Let’s consider an example. Assume that the variable level is level zero. The edges in the other levels are fixed. The expected number of closed triangles with two nodes on the variable level can be computed as follows. Here <code>level</code> is automatically determined to be 0.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/motifs_distribution.html">motifs_distribution</a></span><span class="op">(</span><span class="va">ml_net</span>, motifs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"2,1[II.C]"</span><span class="op">)</span>, model <span class="op">=</span> <span class="st">"actors_choice"</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt;       motif expectation variance</span>
<span class="co">#&gt; 1 2,1[II.C]    19.08899 64.54796</span></code></pre></div>
<p>More interesting is the case of motifs with signature <code>2,2</code>, i.e. with two nodes on two levels. Per default, the variable level is the first level providing two nodes, so level 0 in the first line. Manually, level 1 can be selected as variable level, see second line.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/motifs_distribution.html">motifs_distribution</a></span><span class="op">(</span><span class="va">ml_net</span>, motifs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"2,2[I.A]"</span>, <span class="st">"2,2[I.B]"</span>, <span class="st">"2,2[I.C]"</span>, <span class="st">"2,2[I.D]"</span><span class="op">)</span>, model <span class="op">=</span> <span class="st">"actors_choice"</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt;             motif expectation   variance</span>
<span class="co">#&gt; 2,2[I.A] 2,2[I.A]  3988.44646 20908.0827</span>
<span class="co">#&gt; 2,2[I.B] 2,2[I.B]   371.55354 20908.0827</span>
<span class="co">#&gt; 2,2[I.C] 2,2[I.C]   648.57994   614.8427</span>
<span class="co">#&gt; 2,2[I.D] 2,2[I.D]    60.42006   614.8427</span>
<span class="fu"><a href="../reference/motifs_distribution.html">motifs_distribution</a></span><span class="op">(</span><span class="va">ml_net</span>, motifs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"2,2[I.A]"</span>, <span class="st">"2,2[I.B]"</span>, <span class="st">"2,2[I.C]"</span>, <span class="st">"2,2[I.D]"</span><span class="op">)</span>, model <span class="op">=</span> <span class="st">"actors_choice"</span>, level <span class="op">=</span> <span class="fl">1</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt;             motif expectation    variance</span>
<span class="co">#&gt; 2,2[I.A] 2,2[I.A]  4506.13165 4146.282609</span>
<span class="co">#&gt; 2,2[I.B] 2,2[I.B]   100.88354    9.525781</span>
<span class="co">#&gt; 2,2[I.C] 2,2[I.C]   451.86835 4146.282609</span>
<span class="co">#&gt; 2,2[I.D] 2,2[I.D]    10.11646    9.525781</span></code></pre></div>
<p>Note that in the first line, when level 0 is the variable level, motifs I.A and I.B have the same variance. This is because they only differ in the dyad on the variable level. Similarly, in the second line motifs I.A and I.C have the same variance as they only differ in the dyad on the variable level.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/show_motif.html">show_motif</a></span><span class="op">(</span><span class="st">"2,2[I.A]"</span>, net <span class="op">=</span> <span class="va">ml_net</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="random_baselines_chunk6-1.svg" title="plot of chunk random_baselines_chunk6" alt="plot of chunk random_baselines_chunk6" width="300px"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/show_motif.html">show_motif</a></span><span class="op">(</span><span class="st">"2,2[I.B]"</span>, net <span class="op">=</span> <span class="va">ml_net</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="random_baselines_chunk6-2.svg" title="plot of chunk random_baselines_chunk6" alt="plot of chunk random_baselines_chunk6" width="300px"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/show_motif.html">show_motif</a></span><span class="op">(</span><span class="st">"2,2[I.C]"</span>, net <span class="op">=</span> <span class="va">ml_net</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="random_baselines_chunk6-3.svg" title="plot of chunk random_baselines_chunk6" alt="plot of chunk random_baselines_chunk6" width="300px"></p>
</div>
<div id="exponential-random-graph-models-ergm" class="section level2">
<h2 class="hasAnchor">
<a href="#exponential-random-graph-models-ergm" class="anchor"></a>Exponential Random Graph Models (ERGM)</h2>
<p>ERGMs are a powerful tool to create more advanced, parameterized baseline models. The R library <code>ergm</code> provides various facililties for fitting models based on a multitude of network parameters. motifr can be used to analyse random networks sampled from a given fitted ERGM. In the example below, we fit a basic ergm model to <code>dummy_net</code> including a triangle statistic, capturing a propensity for triangles to occur. We then use the fitted model in a generative way to simulate networks from it and collect to arrive at a baseline distribution based on this model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">ergm</span><span class="op">(</span><span class="va">dummy_net</span> <span class="op">~</span> <span class="va">edges</span> <span class="op">+</span> <span class="va">triangle</span><span class="op">)</span>
<span class="co">#&gt; Starting maximum pseudolikelihood estimation (MPLE):</span>
<span class="co">#&gt; Evaluating the predictor and response matrix.</span>
<span class="co">#&gt; Maximizing the pseudolikelihood.</span>
<span class="co">#&gt; Finished MPLE.</span>
<span class="co">#&gt; Starting Monte Carlo maximum likelihood estimation (MCMLE):</span>
<span class="co">#&gt; Iteration 1 of at most 20:</span>
<span class="co">#&gt; Optimizing with step length 1.</span>
<span class="co">#&gt; The log-likelihood improved by 0.04111.</span>
<span class="co">#&gt; Step length converged once. Increasing MCMC sample size.</span>
<span class="co">#&gt; Iteration 2 of at most 20:</span>
<span class="co">#&gt; Optimizing with step length 1.</span>
<span class="co">#&gt; The log-likelihood improved by 0.0001079.</span>
<span class="co">#&gt; Step length converged twice. Stopping.</span>
<span class="co">#&gt; Finished MCMLE.</span>
<span class="co">#&gt; Evaluating log-likelihood at the estimate. Using 20 bridges: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 .</span>
<span class="co">#&gt; This model was fit using MCMC.  To examine model diagnostics and check</span>
<span class="co">#&gt; for degeneracy, use the mcmc.diagnostics() function.</span>
<span class="fu"><a href="../reference/compare_to_baseline.html">compare_to_baseline</a></span><span class="op">(</span><span class="va">dummy_net</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"1,2[I.A]"</span>, <span class="st">"1,2[I.C]"</span>, <span class="st">"1,2[II.C]"</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">50</span>, directed <span class="op">=</span> <span class="cn">FALSE</span>, model <span class="op">=</span> <span class="st">"ergm"</span>, ergm_model <span class="op">=</span> <span class="va">model</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="random_baselines_chunk7-1.svg" alt="plot of chunk random_baselines_chunk7"><p class="caption">plot of chunk random_baselines_chunk7</p>
</div>
</div>
<div id="workflow-for-partial-ergm" class="section level2">
<h2 class="hasAnchor">
<a href="#workflow-for-partial-ergm" class="anchor"></a>Workflow for Partial ERGM</h2>
<p>The example below illustrates the use of a partial ergm model fit on one level of the network to be used as a baseline model. In this way, all ties except ties on one level of interest are kept fixed. On the level of interest, networks are simulated from an ergm fit to this level and used to create a baseline motif distribution in the multi-level network.</p>
<p>To do this, the subgraph containing only one level of the network is first extracted using <code><a href="../reference/induced_level_subgraph.html">induced_level_subgraph()</a></code>, setting the level to extract (here the actor network on level <code>1</code>). This yields a network object only containing this level to fit an ergm to.</p>
<p>As this example is illustrative, we only fit the most basic ergm model possible, using only a density term. As such, what we do amounts to fitting a Erdős-Rényi model on one level of the multi-level network to be used to simulate a baseline from. But the actual power of using an ERGM lies in the fact that it allows the analyst to account for more subtle processes such as clustering, centralization or homophily.</p>
<p>The resulting model fit (here captured in the object named <code>actor_ergm_model</code>) is then used in <code><a href="../reference/compare_to_baseline.html">compare_to_baseline()</a></code> by passing it to the parameter ergm_model and setting model to partial_ergm. The level parameter further needs to be set to the correct level where the ergm fit is to be used (here <code>1</code> again).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">motifr</span><span class="fu">::</span><span class="va"><a href="../reference/ml_net.html">ml_net</a></span>
<span class="va">actor_net</span> <span class="op">&lt;-</span> <span class="fu">motifr</span><span class="fu">::</span><span class="fu"><a href="../reference/induced_level_subgraph.html">induced_level_subgraph</a></span><span class="op">(</span><span class="va">net</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># very simple ergm model</span>
<span class="va">actor_ergm_model</span> <span class="op">&lt;-</span> <span class="fu">ergm</span><span class="op">(</span><span class="va">actor_net</span> <span class="op">~</span> <span class="va">density</span><span class="op">)</span>
<span class="co">#&gt; Starting maximum pseudolikelihood estimation (MPLE):</span>
<span class="co">#&gt; Evaluating the predictor and response matrix.</span>
<span class="co">#&gt; Maximizing the pseudolikelihood.</span>
<span class="co">#&gt; Finished MPLE.</span>
<span class="co">#&gt; Stopping at the initial estimate.</span>
<span class="co">#&gt; Evaluating log-likelihood at the estimate.</span>

<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="fu"><a href="../reference/compare_to_baseline.html">compare_to_baseline</a></span><span class="op">(</span><span class="va">net</span>,
                    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"1[1]"</span>, <span class="st">"0,1[1]"</span>,
                         <span class="st">"2[1]"</span>, <span class="st">"1,1[1]"</span>, <span class="co"># "0,2[1]", is variable</span>
                         <span class="st">"1,2[I.A]"</span>, <span class="st">"1,2[II.A]"</span>,
                         <span class="st">"1,2[I.B]"</span>, <span class="st">"1,2[II.B]"</span>,
                         <span class="st">"1,2[I.C]"</span>, <span class="st">"1,2[II.C]"</span><span class="op">)</span>,
                    model <span class="op">=</span> <span class="st">"partial_ergm"</span>,
                    ergm_model <span class="op">=</span> <span class="va">actor_ergm_model</span>,
                    n <span class="op">=</span> <span class="va">n</span>,
                    level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="random_baselines_chunk8-1.svg" alt="plot of chunk random_baselines_chunk8"><p class="caption">plot of chunk random_baselines_chunk8</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mario Angst, Tim Seppelt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
